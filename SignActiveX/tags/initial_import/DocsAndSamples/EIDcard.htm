<HTML>
<head>
<link REL="stylesheet" TYPE="text/css" HREF="Style.css">
<script language=vbscript>
function Signfunc(i)
	on error resume next 
	Select Case i
	 Case 0 
  	    document.all.signform.values.value=ISign.getInfo()
		MsgBox document.all.signform.values.value
	Case 1
		document.all.signform.values.value=ISign.getSigningCertificate()
		document.all.signform.selectedCertNumber.value=ISign.selectedCertNumber
		MsgBox document.all.signform.values.value
        view_attributes
	Case 2
	   	document.all.signform.values.value=ISign.getSignedHash(document.all.signform.hash.value,document.all.signform.selectedCertNumber.value)
		MsgBox document.all.signform.values.value
		view_attributes
	End Select


end function 


</script>
</head>

<BODY>

<p><strong><font color="#FF3300" face="Verdana, Arial, Helvetica, sans-serif"><em>EIDCard 
  mooduli testlehek&uuml;lg</em></font></strong></p>
<p><strong>Mis on EIDCard moodul?</strong></p>
<p>EIDCard moodul on COM moodul veebibrauseris, skriptingu keeles, suvalises W32 
  programmis ID-kaardi, AID-kaardiga suhtlemise lihtsustamiseks.<br>
  EIDCard moodul koosneb j&auml;rgmistest objektidest:</p>
<p><strong><font color="#990066">Sign</font></strong></p>
<form id="signform">
  <table width="94%" border="1">
    <tr> 
      <td width="26%"><strong><font color="#CC3300">Meetod</font></strong></td>
      <td width="28%"><strong><font color="#CC3300">Kirjeldus</font></strong></td>
      <td width="46%"><strong><font color="#CC3300">Testi siin</font></strong></td>
    </tr>
    <tr> 
      <td><font color="#993399"><em>String</em></font><strong> getInfo()</strong></td>
      <td>Objekti realisatsiooni versiooni k&uuml;simine</td>
      <td><input name="Sign_getinfo" type="button" id="Sign_getinfo" onClick='signfunc(0)' value="getInfo"></td>
    </tr>
    <tr> 
      <td><em><font color="#993399">String </font></em><strong>getSigningCertificate()</strong></td>
      <td>Signeerimissertifikaadi p&auml;rimine. Tulemuseks v&auml;ljastab valitud 
        sertifikaadi hex-kujul. Objekti atribuut <strong>selected</strong></td>
      <td><input name="Sign_getSigningCertificate" type="button" id="Sign_getSigningCertificate" onClick='Signfunc(1)' value="getSigningCertificate"></td>
    </tr>
    <tr> 
      <td height="78"><em><font color="#993399">String</font></em><strong> getSignedHash(String 
        Hash, long selectedCertNumber)</strong></td>
      <td>Etteantud r&auml;si (<em>Hash</em>) signeerimine. Kasutatakse sertifikaati, 
        mis on kas eelnevalt valitud funktsiooniga <em>getSigningCertificate</em> 
        ja salvestatud atribuuti <em>selectedCertNumber</em>. Kui <em>selectedCertNumber</em> 
        on 0, siis k&uuml;sitakse sertifikaati uuesti.</td>
      <td> <p><strong>Hash</strong> 
          <input name="hash" type="text" id="hash" value="0001020304050607080911121314151617181920" size="40" maxlength="40">
        </p>
        <p><strong>selectedCertNumber</strong> 
          <input name="selectedCertNumber" type="text" id="selectedCertNumber" value="0">
        </p>
        <p> 
          <input name="Sign_getSignedHash" type="button" id="Sign_getSignedHash" value="getSignedHash" onClick='Signfunc(2)'>
        </p></td>
    </tr>
    <tr> 
      <td><strong><font color="#CC3300">Atribuut</font></strong></td>
      <td><strong><font color="#CC3300">Kirjeldus</font></strong></td>
      <td><strong><font color="#CC3300">Testi siin</font></strong></td>
    </tr>
    <tr> 
      <td height="78"><font color="#993399"><em>Long</em></font> <strong>selectedCertNumber</strong></td>
      <td>Sertifikaatide laost tehtud sertifikaadi j&auml;rjekorra number. Kasutatakse 
        selleks, et anda ette funktsioonile <em>getSignedHash</em>.</td>
      <td>vt meetodeid <em>getSigningCertificate</em> ja <em>getSignedHash</em></td>
    </tr>
  </table>
  <p><strong>Tulemused</strong></p>
  <p>
    <textarea cols="80" rows="30" name="values" id="values"></textarea>
  </p>
 

  <p>23.04.2003.l2</p>
  <p>&nbsp;</p>
</form>
<OBJECT id=ISign codebase="EIDCard.dll#Version=1,0,2,4" 
classid=clsid:FC5B7BD2-584A-4153-92D7-4C5840E4BC28></OBJECT>


</BODY></HTML>